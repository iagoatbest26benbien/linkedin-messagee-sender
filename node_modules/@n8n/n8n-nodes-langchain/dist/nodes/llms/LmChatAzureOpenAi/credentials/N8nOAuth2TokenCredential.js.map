{"version":3,"sources":["../../../../../nodes/llms/LmChatAzureOpenAi/credentials/N8nOAuth2TokenCredential.ts"],"sourcesContent":["import type { TokenCredential, AccessToken } from '@azure/identity';\nimport type { INode } from 'n8n-workflow';\nimport { NodeOperationError } from 'n8n-workflow';\n\nimport type { AzureEntraCognitiveServicesOAuth2ApiCredential } from '../types';\n/**\n * Adapts n8n's credential retrieval into the TokenCredential interface expected by @azure/identity\n */\nexport class N8nOAuth2TokenCredential implements TokenCredential {\n\tconstructor(\n\t\tprivate node: INode,\n\t\tprivate credential: AzureEntraCognitiveServicesOAuth2ApiCredential,\n\t) {}\n\n\t/**\n\t * Gets an access token from OAuth credential\n\t */\n\tasync getToken(): Promise<AccessToken | null> {\n\t\ttry {\n\t\t\tif (!this.credential?.oauthTokenData?.access_token) {\n\t\t\t\tthrow new NodeOperationError(this.node, 'Failed to retrieve access token');\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttoken: this.credential.oauthTokenData.access_token,\n\t\t\t\texpiresOnTimestamp: this.credential.oauthTokenData.expires_on,\n\t\t\t};\n\t\t} catch (error) {\n\t\t\t// Re-throw with better error message\n\t\t\tthrow new NodeOperationError(this.node, 'Failed to retrieve OAuth2 access token', error);\n\t\t}\n\t}\n\n\t/**\n\t * Gets the deployment details from the credential\n\t */\n\tasync getDeploymentDetails() {\n\t\treturn {\n\t\t\tapiVersion: this.credential.apiVersion,\n\t\t\tendpoint: this.credential.endpoint,\n\t\t\tresourceName: this.credential.resourceName,\n\t\t};\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,0BAAmC;AAM5B,MAAM,yBAAoD;AAAA,EAChE,YACS,MACA,YACP;AAFO;AACA;AAAA,EACN;AAAA;AAAA;AAAA;AAAA,EAKH,MAAM,WAAwC;AAC7C,QAAI;AACH,UAAI,CAAC,KAAK,YAAY,gBAAgB,cAAc;AACnD,cAAM,IAAI,uCAAmB,KAAK,MAAM,iCAAiC;AAAA,MAC1E;AAEA,aAAO;AAAA,QACN,OAAO,KAAK,WAAW,eAAe;AAAA,QACtC,oBAAoB,KAAK,WAAW,eAAe;AAAA,MACpD;AAAA,IACD,SAAS,OAAO;AAEf,YAAM,IAAI,uCAAmB,KAAK,MAAM,0CAA0C,KAAK;AAAA,IACxF;AAAA,EACD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB;AAC5B,WAAO;AAAA,MACN,YAAY,KAAK,WAAW;AAAA,MAC5B,UAAU,KAAK,WAAW;AAAA,MAC1B,cAAc,KAAK,WAAW;AAAA,IAC/B;AAAA,EACD;AACD;","names":[]}